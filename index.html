<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ ‡∏¢‡∏π‡πà‡∏¢‡∏µ‡πà - ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏£‡∏ö‡∏Ñ‡∏£‡∏±‡∏ô</title>
  <link href="https://fonts.googleapis.com/css2?family=Mali:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            'mali': ['Mali', 'cursive', 'sans-serif']
          },
          colors: {
            'pink-custom': {
              50: '#fef7ff',
              100: '#feeef8',
              200: '#fde2f3',
              300: '#fbc2e4',
              400: '#f692ce',
              500: '#ed64a6',
              600: '#d53f8c',
              700: '#b83280',
              800: '#97266d',
              900: '#702459'
            }
          }
        }
      }
    }
  </script>
  <style>
    @keyframes fadeIn { 
      0% { opacity: 0; transform: translateY(30px); } 
      100% { opacity: 1; transform: translateY(0); } 
    }
    
    @keyframes float { 
      0%, 100% { transform: translateY(0) rotate(0deg); } 
      50% { transform: translateY(-15px) rotate(5deg); } 
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    @keyframes sparkle {
      0%, 100% { opacity: 1; transform: scale(1) rotate(0deg); }
      50% { opacity: 0.7; transform: scale(1.2) rotate(180deg); }
    }
    
    @keyframes wiggle {
      0%, 100% { transform: rotate(-3deg); }
      50% { transform: rotate(3deg); }
    }
    
    @keyframes slideInLeft {
      0% { transform: translateX(-100px); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes slideInRight {
      0% { transform: translateX(100px); opacity: 0; }
      100% { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes celebration {
      0% { transform: scale(0) rotate(0deg); }
      50% { transform: scale(1.2) rotate(180deg); }
      100% { transform: scale(1) rotate(360deg); }
    }
    
    .animate-fadeIn { animation: fadeIn 1s ease-in-out; }
    .animate-float { animation: float 4s ease-in-out infinite; }
    .animate-pulse-custom { animation: pulse 2s ease-in-out infinite; }
    .animate-sparkle { animation: sparkle 3s ease-in-out infinite; }
    .animate-wiggle { animation: wiggle 1s ease-in-out infinite; }
    .animate-slideInLeft { animation: slideInLeft 1s ease-out; }
    .animate-slideInRight { animation: slideInRight 1s ease-out; }
    .animate-celebration { animation: celebration 0.8s ease-out; }
    
    .popup { 
      display: none; 
      position: fixed; 
      top: 0; 
      left: 0; 
      width: 100%; 
      height: 100%; 
      background: rgba(0,0,0,0.6); 
      justify-content: center; 
      align-items: center; 
      z-index: 99999; 
      opacity: 0; 
      transition: opacity 0.3s ease-in-out; 
    }
    
    .popup.show { 
      display: flex; 
      opacity: 1; 
    }
    
    .popup-content { 
      transform: scale(0.8); 
      transition: transform 0.3s cubic-bezier(0.68, -0.55, 0.27, 1.55); 
    }
    
    .popup.show .popup-content { 
      transform: scale(1); 
    }
    
    .floating-elements {
      position: absolute;
      width: 100%;
      height: 100%;
      pointer-events: none;
      overflow: hidden;
    }
    
    .floating-icon {
      position: absolute;
      font-size: 1.5rem;
      opacity: 0.6;
      animation: float 6s ease-in-out infinite;
    }

    .status-pending { background: linear-gradient(135deg, #fef3c7, #fde68a); color: #92400e; }
    .status-partial { background: linear-gradient(135deg, #dbeafe, #93c5fd); color: #1e40af; }
    .status-closed { background: linear-gradient(135deg, #d1fae5, #86efac); color: #065f46; }
    .status-overdue { background: linear-gradient(135deg, #fee2e2, #fca5a5); color: #991b1b; }

    .summary-table {
      font-size: 0.9rem;
      line-height: 1.4;
    }

    .summary-table th {
      background: linear-gradient(135deg, #f3e8ff, #e9d5ff);
      color: #6b21a8;
      font-weight: 600;
      padding: 12px 8px;
      text-align: center;
      border: 1px solid #d8b4fe;
    }

    .summary-table td {
      padding: 10px 8px;
      border: 1px solid #e5e7eb;
      text-align: center;
      background: rgba(255,255,255,0.8);
    }

    .summary-table tr:nth-child(even) td {
      background: rgba(248,250,252,0.9);
    }

    .summary-table tr:hover td {
      background: rgba(243,232,255,0.5);
    }
  </style>
</head>
<body class="font-mali bg-gradient-to-br from-pink-300 via-purple-200 to-pink-200 min-h-screen text-gray-700 relative overflow-x-hidden">
  
  <!-- Floating Background Elements -->
  <div class="floating-elements">
    <div class="floating-icon animate-sparkle" style="top: 10%; left: 5%; animation-delay: 0s;">üíé</div>
    <div class="floating-icon animate-sparkle" style="top: 20%; right: 10%; animation-delay: 1s;">‚ú®</div>
    <div class="floating-icon animate-sparkle" style="top: 60%; left: 8%; animation-delay: 2s;">üå∏</div>
    <div class="floating-icon animate-sparkle" style="top: 70%; right: 5%; animation-delay: 3s;">üí´</div>
    <div class="floating-icon animate-sparkle" style="top: 40%; left: 3%; animation-delay: 4s;">üéÄ</div>
    <div class="floating-icon animate-sparkle" style="top: 80%; right: 15%; animation-delay: 5s;">üí∞</div>
    <div class="floating-icon animate-sparkle" style="top: 30%; right: 3%; animation-delay: 1.5s;">üèÜ</div>
    <div class="floating-icon animate-sparkle" style="top: 50%; left: 12%; animation-delay: 2.5s;">üíµ</div>
  </div>

  <!-- Main Container -->
  <div class="max-w-7xl mx-auto p-4 sm:p-6 lg:p-8 animate-fadeIn relative z-10">
    
    <!-- Header Section -->
    <div class="text-center mb-8 relative">
      <h1 class="text-4xl sm:text-5xl lg:text-6xl font-bold text-pink-custom-600 mb-6 drop-shadow-lg relative z-10 animate-wiggle">
        üí∞ ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ ‡∏¢‡∏π‡πà‡∏¢‡∏µ‡πà üí∞
      </h1>
      
      <!-- Beautiful SVG Bank Icon -->
      <div class="relative mx-auto w-48 h-48 mb-6">
        <svg class="w-full h-full animate-float drop-shadow-2xl" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="bankGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#ff7b9c;stop-opacity:1" />
              <stop offset="50%" style="stop-color:#d946ef;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#a855f7;stop-opacity:1" />
            </linearGradient>
            <linearGradient id="roofGradient" x1="0%" y1="0%" x2="100%" y2="100%">
              <stop offset="0%" style="stop-color:#fbbf24;stop-opacity:1" />
              <stop offset="100%" style="stop-color:#f59e0b;stop-opacity:1" />
            </linearGradient>
            <filter id="glow">
              <feGaussianBlur stdDeviation="3" result="coloredBlur"/>
              <feMerge> 
                <feMergeNode in="coloredBlur"/>
                <feMergeNode in="SourceGraphic"/>
              </feMerge>
            </filter>
          </defs>
          
          <ellipse cx="100" cy="180" rx="80" ry="15" fill="rgba(0,0,0,0.1)"/>
          <rect x="35" y="75" width="130" height="85" fill="url(#bankGradient)" rx="12" filter="url(#glow)"/>
          <rect x="45" y="65" width="14" height="95" fill="#fff" opacity="0.95" rx="7"/>
          <rect x="68" y="65" width="14" height="95" fill="#fff" opacity="0.95" rx="7"/>
          <rect x="91" y="65" width="14" height="95" fill="#fff" opacity="0.95" rx="7"/>
          <rect x="114" y="65" width="14" height="95" fill="#fff" opacity="0.95" rx="7"/>
          <rect x="137" y="65" width="14" height="95" fill="#fff" opacity="0.95" rx="7"/>
          <polygon points="25,75 100,35 175,75 165,85 100,45 35,85" fill="url(#roofGradient)" filter="url(#glow)"/>
          <rect x="82" y="115" width="36" height="45" fill="#8b5cf6" rx="6"/>
          <circle cx="112" cy="137" r="3" fill="#fbbf24"/>
          <rect x="70" y="50" width="60" height="12" fill="#fff" rx="6" opacity="0.9"/>
          <text x="100" y="59" text-anchor="middle" font-size="8" fill="#8b5cf6" font-weight="bold">‡∏¢‡∏π‡πà‡∏¢‡∏µ‡πà BANK</text>
          <circle cx="100" cy="25" r="8" fill="#fbbf24" opacity="0.8"/>
          <polygon points="100,17 103,23 109,23 104,27 106,33 100,29 94,33 96,27 91,23 97,23" fill="#fff"/>
        </svg>
        
        <div class="absolute -top-4 -right-4 w-12 h-12 bg-gradient-to-br from-yellow-400 to-orange-400 rounded-full flex items-center justify-center animate-bounce shadow-lg">
          <span class="text-xl">üí∞</span>
        </div>
        <div class="absolute -bottom-4 -left-4 w-10 h-10 bg-gradient-to-br from-green-400 to-emerald-400 rounded-full flex items-center justify-center animate-bounce shadow-lg" style="animation-delay: 1.5s;">
          <span class="text-lg">üíµ</span>
        </div>
      </div>
    </div>

    <!-- Navigation Tabs -->
    <div class="flex flex-wrap justify-center gap-2 mb-8">
      <button onclick="showTab('add')" id="tab-add" class="tab-button bg-gradient-to-r from-pink-500 to-purple-500 text-white font-bold py-3 px-6 rounded-2xl hover:from-pink-600 hover:to-purple-600 transform hover:scale-105 transition-all duration-300 shadow-lg">
        <span class="animate-bounce">‚ûï</span> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ
      </button>
      <button onclick="showTab('manage')" id="tab-manage" class="tab-button bg-gradient-to-r from-purple-500 to-pink-500 text-white font-bold py-3 px-6 rounded-2xl hover:from-purple-600 hover:to-pink-600 transform hover:scale-105 transition-all duration-300 shadow-lg">
        <span class="animate-wiggle">‚öôÔ∏è</span> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£
      </button>
      <button onclick="showTab('summary')" id="tab-summary" class="tab-button bg-gradient-to-r from-green-500 to-emerald-500 text-white font-bold py-3 px-6 rounded-2xl hover:from-green-600 hover:to-emerald-600 transform hover:scale-105 transition-all duration-300 shadow-lg">
        <span class="animate-sparkle">üìä</span> ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
      </button>
    </div>

    <!-- Add Borrower Tab -->
    <div id="add-tab" class="tab-content">
      <div class="bg-white/90 backdrop-blur-sm rounded-3xl p-6 shadow-2xl border border-pink-100 animate-slideInLeft relative overflow-hidden max-w-2xl mx-auto">
        <div class="absolute top-0 right-0 w-20 h-20 bg-gradient-to-bl from-pink-200 to-transparent rounded-bl-full opacity-50"></div>
        
        <div class="text-center mb-6 relative z-10">
          <h3 class="text-2xl font-bold text-pink-custom-600 flex items-center justify-center gap-2">
            <span class="animate-wiggle">üìù</span> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡∏°‡πà <span class="animate-wiggle">‚ú®</span>
          </h3>
        </div>
        
        <div class="grid md:grid-cols-2 gap-4 relative z-10">
          <div class="relative">
            <label class="block text-sm font-semibold text-pink-custom-700 mb-2 flex items-center gap-2">
              <span class="animate-pulse">üë§</span> ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Å‡∏π‡πâ:
            </label>
            <input type="text" id="borrowerName" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏Å‡∏π‡πâ" 
                   class="w-full px-4 py-3 border-2 border-pink-200 rounded-2xl bg-pink-50 focus:border-pink-400 focus:bg-pink-100 focus:outline-none transition-all duration-300 font-mali hover:shadow-lg">
          </div>
          
          <div class="relative">
            <label class="block text-sm font-semibold text-pink-custom-700 mb-2 flex items-center gap-2">
              <span class="animate-pulse">üí∞</span> ‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô (‡∏ö‡∏≤‡∏ó):
            </label>
            <input type="number" id="principalAmount" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô" 
                   class="w-full px-4 py-3 border-2 border-pink-200 rounded-2xl bg-pink-50 focus:border-pink-400 focus:bg-pink-100 focus:outline-none transition-all duration-300 font-mali hover:shadow-lg">
          </div>
          
          <div class="relative">
            <label class="block text-sm font-semibold text-pink-custom-700 mb-2 flex items-center gap-2">
              <span class="animate-pulse">üìà</span> ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ (% ‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô):
            </label>
            <input type="number" id="interestRate" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢" step="0.1" 
                   class="w-full px-4 py-3 border-2 border-pink-200 rounded-2xl bg-pink-50 focus:border-pink-400 focus:bg-pink-100 focus:outline-none transition-all duration-300 font-mali hover:shadow-lg">
          </div>
          
          <div class="relative">
            <label class="block text-sm font-semibold text-pink-custom-700 mb-2 flex items-center gap-2">
              <span class="animate-pulse">üìÖ</span> ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏¢‡∏∑‡∏°:
            </label>
            <input type="date" id="startDate" 
                   class="w-full px-4 py-3 border-2 border-pink-200 rounded-2xl bg-pink-50 focus:border-pink-400 focus:bg-pink-100 focus:outline-none transition-all duration-300 font-mali hover:shadow-lg">
          </div>
          
          <div class="relative">
            <label class="block text-sm font-semibold text-pink-custom-700 mb-2 flex items-center gap-2">
              <span class="animate-pulse">üìã</span> ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:
            </label>
            <select id="status" class="w-full px-4 py-3 border-2 border-pink-200 rounded-2xl bg-pink-50 focus:border-pink-400 focus:bg-pink-100 focus:outline-none transition-all duration-300 font-mali hover:shadow-lg">
              <option value="pending">‡∏Ñ‡πâ‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞</option>
              <option value="partial">‡∏Ñ‡∏∑‡∏ô‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô</option>
              <option value="closed">‡∏õ‡∏¥‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</option>
              <option value="overdue">‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î</option>
            </select>
          </div>
          
          <div class="relative">
            <label class="block text-sm font-semibold text-pink-custom-700 mb-2 flex items-center gap-2">
              <span class="animate-pulse">üìù</span> ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:
            </label>
            <input type="text" id="notes" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" 
                   class="w-full px-4 py-3 border-2 border-pink-200 rounded-2xl bg-pink-50 focus:border-pink-400 focus:bg-pink-100 focus:outline-none transition-all duration-300 font-mali hover:shadow-lg">
          </div>
        </div>
        
        <div class="text-center mt-6">
          <button onclick="addBorrower()" 
                  class="bg-gradient-to-r from-pink-500 to-purple-500 text-white font-bold py-3 px-8 rounded-2xl hover:from-pink-600 hover:to-purple-600 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center justify-center gap-2 mx-auto">
            <span class="animate-bounce">‚ûï</span> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ <span class="animate-sparkle">‚ú®</span>
          </button>
        </div>
      </div>
    </div>

    <!-- Manage Tab -->
    <div id="manage-tab" class="tab-content hidden">
      <div class="bg-white/90 backdrop-blur-sm rounded-3xl p-6 shadow-2xl border border-pink-100 relative overflow-hidden">
        <div class="text-center mb-6">
          <h3 class="text-2xl font-bold text-pink-custom-600 flex items-center justify-center gap-2">
            <span class="animate-wiggle">‚öôÔ∏è</span> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ <span class="animate-sparkle">üíé</span>
          </h3>
        </div>
        
        <div id="borrowersList" class="space-y-4"></div>
      </div>
    </div>

    <!-- Summary Tab -->
    <div id="summary-tab" class="tab-content hidden">
      <div class="bg-white/90 backdrop-blur-sm rounded-3xl p-6 shadow-2xl border border-pink-100 relative overflow-hidden">
        <div class="text-center mb-6">
          <h3 class="text-2xl font-bold text-pink-custom-600 flex items-center justify-center gap-2">
            <span class="animate-sparkle">üìä</span> ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <span class="animate-wiggle">üí∞</span>
          </h3>
        </div>
        
        <div id="summaryReport" class="overflow-x-auto"></div>
        
        <div class="flex flex-col sm:flex-row gap-4 justify-center mt-6">
          <button onclick="exportToExcel()" 
                  class="bg-gradient-to-r from-green-500 to-emerald-500 text-white font-bold py-3 px-6 rounded-2xl hover:from-green-600 hover:to-emerald-600 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center justify-center gap-2">
            <span class="animate-bounce">üìä</span> Export Excel <span class="animate-sparkle">‚ú®</span>
          </button>
          <button onclick="clearAllData()" 
                  class="bg-gradient-to-r from-red-500 to-pink-500 text-white font-bold py-3 px-6 rounded-2xl hover:from-red-600 hover:to-pink-600 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl flex items-center justify-center gap-2">
            <span class="animate-wiggle">üóëÔ∏è</span> ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <span class="animate-pulse">‚ö†Ô∏è</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Success Popup -->
  <div id="successPopup" class="popup">
    <div class="popup-content bg-white/95 backdrop-blur-sm rounded-3xl p-8 shadow-2xl border border-green-200 max-w-md w-full mx-4 relative overflow-hidden">
      <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-green-400 via-emerald-400 to-green-400"></div>
      <div class="absolute -top-4 -right-4 w-12 h-12 bg-green-400 rounded-full flex items-center justify-center animate-bounce shadow-lg">
        <span class="text-2xl">üéâ</span>
      </div>
      
      <div class="text-center">
        <div class="text-6xl mb-4 animate-celebration">‚úÖ</div>
        <h3 class="text-2xl font-bold text-green-600 mb-4">‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!</h3>
        <p id="successMessage" class="text-gray-700 mb-6 text-lg"></p>
        <button onclick="closeSuccessPopup()" 
                class="bg-gradient-to-r from-green-500 to-emerald-500 text-white font-bold py-3 px-8 rounded-2xl hover:from-green-600 hover:to-emerald-600 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl">
          <span class="animate-pulse">üëç</span> ‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°!
        </button>
      </div>
    </div>
  </div>

  <!-- Error Popup -->
  <div id="errorPopup" class="popup">
    <div class="popup-content bg-white/95 backdrop-blur-sm rounded-3xl p-8 shadow-2xl border border-red-200 max-w-md w-full mx-4 relative overflow-hidden">
      <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-red-400 via-pink-400 to-red-400"></div>
      <div class="absolute -top-4 -right-4 w-12 h-12 bg-red-400 rounded-full flex items-center justify-center animate-wiggle shadow-lg">
        <span class="text-2xl">‚ö†Ô∏è</span>
      </div>
      
      <div class="text-center">
        <div class="text-6xl mb-4 animate-wiggle">üö®</div>
        <h3 class="text-2xl font-bold text-red-600 mb-4">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î!</h3>
        <p id="errorMessage" class="text-gray-700 mb-6 text-lg"></p>
        <button onclick="closeErrorPopup()" 
                class="bg-gradient-to-r from-red-500 to-pink-500 text-white font-bold py-3 px-8 rounded-2xl hover:from-red-600 hover:to-pink-600 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl">
          <span class="animate-pulse">üîÑ</span> ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
        </button>
      </div>
    </div>
  </div>

  <!-- Confirm Popup -->
  <div id="confirmPopup" class="popup">
    <div class="popup-content bg-white/95 backdrop-blur-sm rounded-3xl p-8 shadow-2xl border border-orange-200 max-w-md w-full mx-4 relative overflow-hidden">
      <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-orange-400 via-yellow-400 to-orange-400"></div>
      <div class="absolute -top-4 -right-4 w-12 h-12 bg-orange-400 rounded-full flex items-center justify-center animate-pulse shadow-lg">
        <span class="text-2xl">ü§î</span>
      </div>
      
      <div class="text-center">
        <div class="text-6xl mb-4 animate-wiggle">‚ùì</div>
        <h3 class="text-2xl font-bold text-orange-600 mb-4">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h3>
        <p id="confirmMessage" class="text-gray-700 mb-6 text-lg"></p>
        <div class="flex gap-4 justify-center">
          <button id="confirmYes" 
                  class="bg-gradient-to-r from-red-500 to-pink-500 text-white font-bold py-3 px-6 rounded-2xl hover:from-red-600 hover:to-pink-600 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl">
            <span class="animate-wiggle">‚úÖ</span> ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
          </button>
          <button onclick="closeConfirmPopup()" 
                  class="bg-gradient-to-r from-gray-500 to-gray-600 text-white font-bold py-3 px-6 rounded-2xl hover:from-gray-600 hover:to-gray-700 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl">
            <span class="animate-pulse">‚ùå</span> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Payment/Transaction Popup -->
  <div id="transactionPopup" class="popup">
    <div class="popup-content bg-white/95 backdrop-blur-sm rounded-3xl p-8 shadow-2xl border border-blue-200 max-w-md w-full mx-4 relative overflow-hidden">
      <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-400 via-purple-400 to-blue-400"></div>
      
      <div class="text-center mb-6">
        <h3 class="text-2xl font-bold text-blue-600 flex items-center justify-center gap-2">
          <span class="animate-bounce">üí≥</span> <span id="transactionTitle">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞</span>
        </h3>
      </div>
      
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-semibold text-blue-700 mb-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó):</label>
          <input type="number" id="transactionAmount" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" 
                 class="w-full px-4 py-3 border-2 border-blue-200 rounded-2xl bg-blue-50 focus:border-blue-400 focus:bg-blue-100 focus:outline-none transition-all duration-300 font-mali">
        </div>
        
        <div>
          <label class="block text-sm font-semibold text-blue-700 mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</label>
          <input type="date" id="transactionDate" 
                 class="w-full px-4 py-3 border-2 border-blue-200 rounded-2xl bg-blue-50 focus:border-blue-400 focus:bg-blue-100 focus:outline-none transition-all duration-300 font-mali">
        </div>
        
        <div>
          <label class="block text-sm font-semibold text-blue-700 mb-2">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</label>
          <input type="text" id="transactionNote" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" 
                 class="w-full px-4 py-3 border-2 border-blue-200 rounded-2xl bg-blue-50 focus:border-blue-400 focus:bg-blue-100 focus:outline-none transition-all duration-300 font-mali">
        </div>
      </div>
      
      <div class="flex gap-4 justify-center mt-6">
        <button id="saveTransaction" 
                class="bg-gradient-to-r from-blue-500 to-purple-500 text-white font-bold py-3 px-6 rounded-2xl hover:from-blue-600 hover:to-purple-600 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl">
          <span class="animate-bounce">üíæ</span> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
        </button>
        <button onclick="closeTransactionPopup()" 
                class="bg-gradient-to-r from-gray-500 to-gray-600 text-white font-bold py-3 px-6 rounded-2xl hover:from-gray-600 hover:to-gray-700 transform hover:scale-105 transition-all duration-300 shadow-lg hover:shadow-xl">
          <span class="animate-pulse">‚ùå</span> ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
        </button>
      </div>
    </div>
  </div>

  <script>
    let borrowers = JSON.parse(localStorage.getItem('borrowers')) || [];
    let currentBorrowerId = null;
    let currentTransactionType = null;
    let confirmCallback = null;

    // Utility functions
    function formatNumber(num) {
      return new Intl.NumberFormat('th-TH').format(num);
    }

    function formatDate(dateStr) {
      return new Date(dateStr).toLocaleDateString('th-TH');
    }

    function calculateDaysBetween(startDate, endDate = new Date()) {
      const start = new Date(startDate);
      const end = new Date(endDate);
      const diffTime = Math.abs(end - start);
      return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    }

    function calculateDailyInterest(principal, monthlyRate) {
      return (principal * monthlyRate / 100) / 30;
    }

    function calculateAccumulatedInterest(borrower) {
      const days = calculateDaysBetween(borrower.startDate);
      const dailyInterest = calculateDailyInterest(borrower.principal, borrower.interestRate);
      return dailyInterest * days;
    }

    function getNextPaymentDate(startDate) {
      const start = new Date(startDate);
      const today = new Date();
      const nextMonth = new Date(start);
      
      while (nextMonth <= today) {
        nextMonth.setMonth(nextMonth.getMonth() + 1);
      }
      
      return nextMonth.toISOString().split('T')[0];
    }

    // Popup functions
    function showSuccessPopup(message) {
      document.getElementById('successMessage').textContent = message;
      document.getElementById('successPopup').classList.add('show');
      setTimeout(() => closeSuccessPopup(), 3000);
    }

    function closeSuccessPopup() {
      document.getElementById('successPopup').classList.remove('show');
    }

    function showErrorPopup(message) {
      document.getElementById('errorMessage').textContent = message;
      document.getElementById('errorPopup').classList.add('show');
    }

    function closeErrorPopup() {
      document.getElementById('errorPopup').classList.remove('show');
    }

    function showConfirmPopup(message, callback) {
      document.getElementById('confirmMessage').textContent = message;
      confirmCallback = callback;
      document.getElementById('confirmYes').onclick = function() {
        closeConfirmPopup();
        if (confirmCallback) confirmCallback();
      };
      document.getElementById('confirmPopup').classList.add('show');
    }

    function closeConfirmPopup() {
      document.getElementById('confirmPopup').classList.remove('show');
      confirmCallback = null;
    }

    function showTransactionPopup(borrowerId, type, title) {
      currentBorrowerId = borrowerId;
      currentTransactionType = type;
      document.getElementById('transactionTitle').textContent = title;
      document.getElementById('transactionDate').value = new Date().toISOString().split('T')[0];
      document.getElementById('transactionAmount').value = '';
      document.getElementById('transactionNote').value = '';
      document.getElementById('transactionPopup').classList.add('show');
    }

    function closeTransactionPopup() {
      document.getElementById('transactionPopup').classList.remove('show');
      currentBorrowerId = null;
      currentTransactionType = null;
    }

    // Tab functions
    function showTab(tabName) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.add('hidden');
      });
      
      // Remove active class from all buttons
      document.querySelectorAll('.tab-button').forEach(btn => {
        btn.classList.remove('ring-4', 'ring-pink-300');
      });
      
      // Show selected tab
      document.getElementById(tabName + '-tab').classList.remove('hidden');
      document.getElementById('tab-' + tabName).classList.add('ring-4', 'ring-pink-300');
      
      // Update content based on tab
      if (tabName === 'manage') {
        displayBorrowersList();
      } else if (tabName === 'summary') {
        generateSummaryReport();
      }
    }

    // Main functions
    function addBorrower() {
      const name = document.getElementById('borrowerName').value.trim();
      const principal = parseFloat(document.getElementById('principalAmount').value);
      const rate = parseFloat(document.getElementById('interestRate').value);
      const startDate = document.getElementById('startDate').value;
      const status = document.getElementById('status').value;
      const notes = document.getElementById('notes').value.trim();

      if (!name || !principal || !rate || !startDate) {
        showErrorPopup('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
        return;
      }

      const borrower = {
        id: Date.now(),
        name: name,
        principal: principal,
        interestRate: rate,
        startDate: startDate,
        status: status,
        notes: notes,
        interestPayments: [],
        principalPayments: [],
        createdAt: new Date().toISOString()
      };

      borrowers.push(borrower);
      localStorage.setItem('borrowers', JSON.stringify(borrowers));
      
      // Clear form
      document.getElementById('borrowerName').value = '';
      document.getElementById('principalAmount').value = '';
      document.getElementById('interestRate').value = '';
      document.getElementById('startDate').value = '';
      document.getElementById('status').value = 'pending';
      document.getElementById('notes').value = '';

      showSuccessPopup(`‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ "${name}" ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!`);
    }

    function displayBorrowersList() {
      const container = document.getElementById('borrowersList');
      container.innerHTML = '';

      if (borrowers.length === 0) {
        container.innerHTML = `
          <div class="text-center text-gray-500 py-12">
            <div class="text-6xl mb-4 animate-bounce">üìù</div>
            <p class="text-lg">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
            <p class="text-sm mt-2">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å‡∏Å‡∏±‡∏ô‡πÄ‡∏ñ‡∏≠‡∏∞! üåü</p>
          </div>
        `;
        return;
      }

      borrowers.forEach((borrower, index) => {
        const days = calculateDaysBetween(borrower.startDate);
        const accumulatedInterest = calculateAccumulatedInterest(borrower);
        const statusClass = `status-${borrower.status}`;
        
        const item = document.createElement('div');
        item.className = 'bg-white/80 rounded-2xl p-6 shadow-md hover:shadow-lg transition-all duration-300 border border-pink-100 relative overflow-hidden';
        item.innerHTML = `
          <div class="absolute top-0 right-0 w-16 h-16 bg-gradient-to-bl from-pink-200 to-transparent rounded-bl-full opacity-30"></div>
          
          <div class="flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4 relative z-10">
            <div class="flex-1">
              <div class="flex items-center gap-3 mb-3">
                <div class="font-bold text-pink-custom-700 text-xl flex items-center gap-2">
                  <span class="animate-pulse">${index % 2 === 0 ? 'üë§' : 'üë©'}</span>
                  ${borrower.name}
                </div>
                <div class="px-3 py-1 rounded-full text-sm font-semibold ${statusClass}">
                  ${getStatusText(borrower.status)}
                </div>
              </div>
              
              <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 text-sm">
                <div class="bg-gradient-to-r from-pink-100 to-pink-200 px-3 py-2 rounded-xl">
                  <div class="text-pink-700 font-semibold">üí∞ ‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô</div>
                  <div class="text-pink-800 font-bold">‡∏ø${formatNumber(borrower.principal)}</div>
                </div>
                <div class="bg-gradient-to-r from-purple-100 to-purple-200 px-3 py-2 rounded-xl">
                  <div class="text-purple-700 font-semibold">üìà ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢</div>
                  <div class="text-purple-800 font-bold">${borrower.interestRate}%/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
                </div>
                <div class="bg-gradient-to-r from-blue-100 to-blue-200 px-3 py-2 rounded-xl">
                  <div class="text-blue-700 font-semibold">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°</div>
                  <div class="text-blue-800 font-bold">${formatDate(borrower.startDate)}</div>
                </div>
                <div class="bg-gradient-to-r from-green-100 to-green-200 px-3 py-2 rounded-xl">
                  <div class="text-green-700 font-semibold">‚è∞ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô</div>
                  <div class="text-green-800 font-bold">${days} ‡∏ß‡∏±‡∏ô</div>
                </div>
              </div>
              
              <div class="mt-3 text-sm">
                <div class="text-pink-600 font-semibold flex items-center gap-1">
                  <span class="animate-pulse">üíé</span>
                  ‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏™‡∏∞‡∏™‡∏°: <span class="text-pink-700 font-bold">‡∏ø${formatNumber(Math.round(accumulatedInterest))}</span>
                </div>
                ${borrower.notes ? `<div class="text-gray-600 mt-1">üìù ${borrower.notes}</div>` : ''}
              </div>
            </div>
            
            <div class="flex flex-wrap gap-2">
              <button onclick="showTransactionPopup(${borrower.id}, 'interest', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢')" 
                      class="bg-gradient-to-r from-green-400 to-green-500 text-white font-bold py-2 px-4 rounded-xl hover:from-green-500 hover:to-green-600 transform hover:scale-105 transition-all duration-300 shadow-md text-sm">
                üí≥ ‡πÇ‡∏≠‡∏ô‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢
              </button>
              <button onclick="showTransactionPopup(${borrower.id}, 'principal', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô')" 
                      class="bg-gradient-to-r from-blue-400 to-blue-500 text-white font-bold py-2 px-4 rounded-xl hover:from-blue-500 hover:to-blue-600 transform hover:scale-105 transition-all duration-300 shadow-md text-sm">
                üí∞ ‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô
              </button>
              <button onclick="editBorrower(${borrower.id})" 
                      class="bg-gradient-to-r from-yellow-400 to-yellow-500 text-white font-bold py-2 px-4 rounded-xl hover:from-yellow-500 hover:to-yellow-600 transform hover:scale-105 transition-all duration-300 shadow-md text-sm">
                ‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
              </button>
              <button onclick="deleteBorrower(${borrower.id})" 
                      class="bg-gradient-to-r from-red-400 to-red-500 text-white font-bold py-2 px-4 rounded-xl hover:from-red-500 hover:to-red-600 transform hover:scale-105 transition-all duration-300 shadow-md text-sm">
                üóëÔ∏è ‡∏•‡∏ö
              </button>
            </div>
          </div>
          
          ${borrower.interestPayments.length > 0 || borrower.principalPayments.length > 0 ? `
            <div class="mt-4 pt-4 border-t border-pink-200">
              <div class="text-sm text-gray-600">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                  ${borrower.interestPayments.length > 0 ? `
                    <div>
                      <div class="font-semibold text-green-600 mb-2">üí≥ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢:</div>
                      <div class="space-y-1 max-h-20 overflow-y-auto">
                        ${borrower.interestPayments.slice(-3).map(payment => `
                          <div class="text-xs bg-green-50 px-2 py-1 rounded">
                            ${formatDate(payment.date)}: ‡∏ø${formatNumber(payment.amount)}
                            ${payment.note ? ` (${payment.note})` : ''}
                          </div>
                        `).join('')}
                      </div>
                    </div>
                  ` : ''}
                  
                  ${borrower.principalPayments.length > 0 ? `
                    <div>
                      <div class="font-semibold text-blue-600 mb-2">üí∞ ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∑‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô:</div>
                      <div class="space-y-1 max-h-20 overflow-y-auto">
                        ${borrower.principalPayments.slice(-3).map(payment => `
                          <div class="text-xs bg-blue-50 px-2 py-1 rounded">
                            ${formatDate(payment.date)}: ‡∏ø${formatNumber(payment.amount)}
                            ${payment.note ? ` (${payment.note})` : ''}
                          </div>
                        `).join('')}
                      </div>
                    </div>
                  ` : ''}
                </div>
              </div>
            </div>
          ` : ''}
        `;
        container.appendChild(item);
      });
    }

    function getStatusText(status) {
      const statusMap = {
        'pending': '‡∏Ñ‡πâ‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞',
        'partial': '‡∏Ñ‡∏∑‡∏ô‡∏ö‡∏≤‡∏á‡∏™‡πà‡∏ß‡∏ô',
        'closed': '‡∏õ‡∏¥‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ',
        'overdue': '‡πÄ‡∏Å‡∏¥‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î'
      };
      return statusMap[status] || status;
    }

    function saveTransaction() {
      const amount = parseFloat(document.getElementById('transactionAmount').value);
      const date = document.getElementById('transactionDate').value;
      const note = document.getElementById('transactionNote').value.trim();

      if (!amount || !date) {
        showErrorPopup('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà');
        return;
      }

      const borrowerIndex = borrowers.findIndex(b => b.id === currentBorrowerId);
      if (borrowerIndex === -1) {
        showErrorPopup('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ');
        return;
      }

      const transaction = {
        id: Date.now(),
        amount: amount,
        date: date,
        note: note,
        createdAt: new Date().toISOString()
      };

      if (currentTransactionType === 'interest') {
        borrowers[borrowerIndex].interestPayments.push(transaction);
      } else if (currentTransactionType === 'principal') {
        borrowers[borrowerIndex].principalPayments.push(transaction);
      }

      localStorage.setItem('borrowers', JSON.stringify(borrowers));
      closeTransactionPopup();
      displayBorrowersList();
      
      const transactionTypeText = currentTransactionType === 'interest' ? '‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢' : '‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô';
      showSuccessPopup(`‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞${transactionTypeText} ‡∏ø${formatNumber(amount)} ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!`);
    }

    function generateSummaryReport() {
      const container = document.getElementById('summaryReport');
      
      if (borrowers.length === 0) {
        container.innerHTML = `
          <div class="text-center text-gray-500 py-12">
            <div class="text-6xl mb-4 animate-bounce">üìä</div>
            <p class="text-lg">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô</p>
            <p class="text-sm mt-2">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏™‡∏£‡∏∏‡∏õ üåü</p>
          </div>
        `;
        return;
      }

      let totalPrincipal = 0;
      let totalAccumulatedInterest = 0;
      let totalNextMonthInterest = 0;

      const tableRows = borrowers.map(borrower => {
        const days = calculateDaysBetween(borrower.startDate);
        const accumulatedInterest = calculateAccumulatedInterest(borrower);
        const monthlyInterest = (borrower.principal * borrower.interestRate / 100);
        const nextPaymentDate = getNextPaymentDate(borrower.startDate);
        
        totalPrincipal += borrower.principal;
        totalAccumulatedInterest += accumulatedInterest;
        totalNextMonthInterest += monthlyInterest;

        return `
          <tr>
            <td class="font-semibold">${borrower.name}</td>
            <td>‡∏ø${formatNumber(borrower.principal)}</td>
            <td>${borrower.interestRate}%</td>
            <td>${formatDate(borrower.startDate)}</td>
            <td>${days} ‡∏ß‡∏±‡∏ô</td>
            <td class="font-semibold text-pink-600">‡∏ø${formatNumber(Math.round(accumulatedInterest))}</td>
            <td class="font-semibold text-purple-600">‡∏ø${formatNumber(Math.round(monthlyInterest))}</td>
            <td>${formatDate(nextPaymentDate)}</td>
            <td><span class="px-2 py-1 rounded-full text-xs font-semibold status-${borrower.status}">${getStatusText(borrower.status)}</span></td>
          </tr>
        `;
      }).join('');

      container.innerHTML = `
        <div class="bg-gradient-to-r from-purple-100 to-pink-100 rounded-2xl p-6 mb-6">
          <h4 class="text-xl font-bold text-purple-700 mb-4 text-center flex items-center justify-center gap-2">
            <span class="animate-sparkle">üìã</span> ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <span class="animate-wiggle">üíé</span>
          </h4>
          
          <div class="overflow-x-auto">
            <table class="summary-table w-full border-collapse rounded-lg overflow-hidden shadow-lg">
              <thead>
                <tr>
                  <th>‡∏ä‡∏∑‡πà‡∏≠</th>
                  <th>‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô</th>
                  <th>‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
                  <th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏¢‡∏∑‡∏°</th>
                  <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤</th>
                  <th>‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏™‡∏∞‡∏™‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö</th>
                  <th>‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</th>
                  <th>‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡πà‡∏≤‡∏¢‡∏î‡∏≠‡∏Å‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</th>
                  <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
                </tr>
              </thead>
              <tbody>
                ${tableRows}
              </tbody>
            </table>
          </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
          <div class="bg-gradient-to-br from-pink-100 to-pink-200 rounded-2xl p-6 text-center shadow-lg">
            <div class="text-3xl mb-2 animate-pulse">üí∞</div>
            <div class="text-2xl font-bold text-pink-700 mb-2">‡∏ø${formatNumber(totalPrincipal)}</div>
            <div class="text-sm text-pink-600 font-semibold">‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
          </div>
          
          <div class="bg-gradient-to-br from-purple-100 to-purple-200 rounded-2xl p-6 text-center shadow-lg">
            <div class="text-3xl mb-2 animate-sparkle">üíé</div>
            <div class="text-2xl font-bold text-purple-700 mb-2">‡∏ø${formatNumber(Math.round(totalAccumulatedInterest))}</div>
            <div class="text-sm text-purple-600 font-semibold">‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏™‡∏∞‡∏™‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö</div>
          </div>
          
          <div class="bg-gradient-to-br from-green-100 to-green-200 rounded-2xl p-6 text-center shadow-lg">
            <div class="text-3xl mb-2 animate-bounce">üìà</div>
            <div class="text-2xl font-bold text-green-700 mb-2">‡∏ø${formatNumber(Math.round(totalNextMonthInterest))}</div>
            <div class="text-sm text-green-600 font-semibold">‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</div>
          </div>
        </div>
      `;
    }

    function editBorrower(id) {
      const borrower = borrowers.find(b => b.id === id);
      if (!borrower) return;

      // Fill form with existing data
      document.getElementById('borrowerName').value = borrower.name;
      document.getElementById('principalAmount').value = borrower.principal;
      document.getElementById('interestRate').value = borrower.interestRate;
      document.getElementById('startDate').value = borrower.startDate;
      document.getElementById('status').value = borrower.status;
      document.getElementById('notes').value = borrower.notes || '';

      // Switch to add tab
      showTab('add');

      // Change button to update mode
      const addButton = document.querySelector('#add-tab button[onclick="addBorrower()"]');
      addButton.innerHTML = '<span class="animate-bounce">‚úèÔ∏è</span> ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• <span class="animate-sparkle">‚ú®</span>';
      addButton.onclick = function() { updateBorrower(id); };

      showSuccessPopup(`‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• "${borrower.name}"`);
    }

    function updateBorrower(id) {
      const name = document.getElementById('borrowerName').value.trim();
      const principal = parseFloat(document.getElementById('principalAmount').value);
      const rate = parseFloat(document.getElementById('interestRate').value);
      const startDate = document.getElementById('startDate').value;
      const status = document.getElementById('status').value;
      const notes = document.getElementById('notes').value.trim();

      if (!name || !principal || !rate || !startDate) {
        showErrorPopup('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
        return;
      }

      const borrowerIndex = borrowers.findIndex(b => b.id === id);
      if (borrowerIndex === -1) {
        showErrorPopup('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ');
        return;
      }

      borrowers[borrowerIndex] = {
        ...borrowers[borrowerIndex],
        name: name,
        principal: principal,
        interestRate: rate,
        startDate: startDate,
        status: status,
        notes: notes,
        updatedAt: new Date().toISOString()
      };

      localStorage.setItem('borrowers', JSON.stringify(borrowers));
      
      // Reset form and button
      document.getElementById('borrowerName').value = '';
      document.getElementById('principalAmount').value = '';
      document.getElementById('interestRate').value = '';
      document.getElementById('startDate').value = '';
      document.getElementById('status').value = 'pending';
      document.getElementById('notes').value = '';

      const addButton = document.querySelector('#add-tab button');
      addButton.innerHTML = '<span class="animate-bounce">‚ûï</span> ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ <span class="animate-sparkle">‚ú®</span>';
      addButton.onclick = addBorrower;

      showSuccessPopup(`‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• "${name}" ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!`);
      showTab('manage');
    }

    function deleteBorrower(id) {
      const borrower = borrowers.find(b => b.id === id);
      if (!borrower) return;

      showConfirmPopup(`‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ "${borrower.name}" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ`, function() {
        borrowers = borrowers.filter(b => b.id !== id);
        localStorage.setItem('borrowers', JSON.stringify(borrowers));
        displayBorrowersList();
        showSuccessPopup(`‡∏•‡∏ö‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ "${borrower.name}" ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!`);
      });
    }

    function exportToExcel() {
      if (borrowers.length === 0) {
        showErrorPopup('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ Export');
        return;
      }

      const exportData = borrowers.map(borrower => {
        const days = calculateDaysBetween(borrower.startDate);
        const accumulatedInterest = calculateAccumulatedInterest(borrower);
        const monthlyInterest = (borrower.principal * borrower.interestRate / 100);
        const nextPaymentDate = getNextPaymentDate(borrower.startDate);

        return {
          '‡∏ä‡∏∑‡πà‡∏≠': borrower.name,
          '‡πÄ‡∏á‡∏¥‡∏ô‡∏ï‡πâ‡∏ô': borrower.principal,
          '‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ï‡πà‡∏≠‡πÄ‡∏î‡∏∑‡∏≠‡∏ô': borrower.interestRate + '%',
          '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏¢‡∏∑‡∏°': borrower.startDate,
          '‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤': days,
          '‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏™‡∏∞‡∏™‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö': Math.round(accumulatedInterest),
          '‡∏î‡∏≠‡∏Å‡πÄ‡∏ö‡∏µ‡πâ‡∏¢‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ': Math.round(monthlyInterest),
          '‡∏ß‡∏±‡∏ô‡∏Ñ‡∏£‡∏ö‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡πà‡∏≤‡∏¢‡∏î‡∏≠‡∏Å‡∏ñ‡∏±‡∏î‡πÑ‡∏õ': nextPaymentDate,
          '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': getStatusText(borrower.status),
          '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏': borrower.notes || ''
        };
      });

      const ws = XLSX.utils.json_to_sheet(exportData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, '‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ');
      XLSX.writeFile(wb, `‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÄ‡∏á‡∏¥‡∏ô‡∏Å‡∏π‡πâ_‡∏¢‡∏π‡πà‡∏¢‡∏µ‡πà_${new Date().toISOString().split('T')[0]}.xlsx`);
      showSuccessPopup('Export Excel ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß!');
    }

    function clearAllData() {
      showConfirmPopup('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ', function() {
        borrowers = [];
        localStorage.removeItem('borrowers');
        displayBorrowersList();
        generateSummaryReport();
        showSuccessPopup('‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
      });
    }

    // Event listeners
    document.getElementById('saveTransaction').onclick = saveTransaction;

    // Initialize on page load
    window.onload = function() {
      // Set today's date as default
      document.getElementById('startDate').value = new Date().toISOString().split('T')[0];
      
      // Show default tab
      showTab('add');
    };
  </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97309c9da1bd9102',t:'MTc1NTg0NzI3MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
